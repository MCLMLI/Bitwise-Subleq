# BS Java è§£é‡Šå™¨

ä¸­æ–‡ | [English](README_EN.md)

Java å®ç°çš„ BS (Bitwise Subleq) è§£é‡Šå™¨ï¼Œå…·æœ‰å®Œæ•´çš„è°ƒè¯•åŠŸèƒ½å’ŒåŒè¯­æ”¯æŒã€‚

> **è¯­è¨€è§„èŒƒ**: å®Œæ•´çš„ BS è¯­è¨€è§„èŒƒè¯·å‚é˜… [é¡¹ç›®æ ¹ç›®å½• README](../../README.md)

## åŠŸèƒ½ç‰¹æ€§

- âœ… å®Œæ•´çš„ BS è¯­è¨€æ”¯æŒ
- âœ… è°ƒè¯•æ¨¡å¼ï¼ˆå•æ­¥æ‰§è¡Œã€å†…å­˜æŸ¥çœ‹ï¼‰
- âœ… ä¸­è‹±åŒè¯­ç•Œé¢
- âœ… ä»æ–‡ä»¶æˆ–å‘½ä»¤è¡Œè¯»å–ç¨‹åº
- âœ… è¯¦ç»†çš„é”™è¯¯æç¤º
- âœ… æ‰§è¡Œç»Ÿè®¡ä¿¡æ¯
- âœ… å¯é…ç½®çš„æ‰§è¡Œé™åˆ¶

## å¿«é€Ÿå¼€å§‹

### ç¼–è¯‘é¡¹ç›®

```bash
cd Interpreter/Java
.\gradlew.bat build     # Windows
./gradlew build         # Linux/Mac
```

### è¿è¡Œç¨‹åº

#### åŸºæœ¬ç”¨æ³•

```bash
# ä»å‘½ä»¤è¡Œæ‰§è¡Œæ¯”ç‰¹æµ
java -cp build\classes\java\main BSMain -e <bitstream>

# ä»æ–‡ä»¶æ‰§è¡Œ
java -cp build\classes\java\main BSMain <filename>

# è°ƒè¯•æ¨¡å¼
java -cp build\classes\java\main BSMain -d -e <bitstream>
```

#### ç¤ºä¾‹

```bash
# æ— é™å¾ªç¯ç¤ºä¾‹
java -cp build\classes\java\main BSMain -e 000000000000000

# è¾“å‡ºæµ‹è¯•
java -cp build\classes\java\main BSMain -e 100010000111111

# ä½¿ç”¨æµ‹è¯•æ–‡ä»¶
java -cp build\classes\java\main BSMain test_infinite_loop.bs
java -cp build\classes\java\main BSMain test_output_a.bs
```

## å‘½ä»¤è¡Œé€‰é¡¹

| é€‰é¡¹ | è¯´æ˜ |
|------|------|
| `-e <bitstream>` | ç›´æ¥æ‰§è¡Œæ¯”ç‰¹æµå­—ç¬¦ä¸² |
| `-d, --debug` | å¯ç”¨è°ƒè¯•æ¨¡å¼ï¼ˆå•æ­¥æ‰§è¡Œï¼‰ |
| `--lang <zh\|en>` | è®¾ç½®ç•Œé¢è¯­è¨€ï¼ˆé»˜è®¤ï¼šzhï¼‰ |
| `-h, --help` | æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ |
| `<filename>` | ä»æ–‡ä»¶è¯»å–å¹¶æ‰§è¡Œç¨‹åº |

## ç¯å¢ƒå˜é‡

| å˜é‡ | å€¼ | è¯´æ˜ |
|------|-----|------|
| `BS_LANG` | `zh` / `en` | è®¾ç½®ç•Œé¢è¯­è¨€ |
| `BS_DEBUG` | `1` | å¯ç”¨è¯¦ç»†è°ƒè¯•è¾“å‡º |
| `BS_VERBOSE` | `1` | æ˜¾ç¤ºæ‰§è¡Œç»Ÿè®¡ä¿¡æ¯ |

**ç¤ºä¾‹:**
```bash
set BS_LANG=en
set BS_DEBUG=1
java -cp build\classes\java\main BSMain -e 000000000000000
```

## é¡¹ç›®ç»“æ„

```
Interpreter/Java/
â”œâ”€â”€ src/main/java/
â”‚   â”œâ”€â”€ BitReader.java       # æ¯”ç‰¹æµè§£æå™¨æ¥å£
â”‚   â”œâ”€â”€ SimpleBitReader.java # 5ä½å—è§£æå®ç°
â”‚   â”œâ”€â”€ BSInterpreter.java   # BS è§£é‡Šå™¨æ ¸å¿ƒ
â”‚   â”œâ”€â”€ BSMain.java          # å‘½ä»¤è¡Œå…¥å£
â”‚   â”œâ”€â”€ Lang.java            # å¤šè¯­è¨€æ”¯æŒ
â”‚   â””â”€â”€ TestDecoding.java    # åœ°å€è§£ç æµ‹è¯•å·¥å…·
â”œâ”€â”€ test_*.bs                # æµ‹è¯•ç¨‹åº
â”œâ”€â”€ build.gradle             # Gradle æ„å»ºé…ç½®
â””â”€â”€ README.md               # æœ¬æ–‡ä»¶
```

## æ ¸å¿ƒç»„ä»¶è¯´æ˜

### BitReader
æ¯”ç‰¹æµè¯»å–æ¥å£ï¼Œæ”¯æŒæŒ‰ä½è¯»å–å’Œåœ°å€è§£ç ã€‚

### SimpleBitReader
å®ç° 5ä½å—çš„è§£æé€»è¾‘ï¼Œå¤„ç†è‡ªç»ˆæ­¢åœ°å€ç¼–ç ã€‚

### BSInterpreter
è§£é‡Šå™¨æ ¸å¿ƒï¼ŒåŒ…å«ï¼š
- æŒ‡ä»¤è§£ç å’Œæ‰§è¡Œ
- ç¨€ç–å†…å­˜ç®¡ç†ï¼ˆHashMapï¼‰
- I/O æ“ä½œå¤„ç†
- ç‰¹æ®Šåœ°å€ -1 çš„å¤„ç†

### BSMain
å‘½ä»¤è¡Œç•Œé¢ï¼Œæä¾›ï¼š
- å‚æ•°è§£æ
- æ–‡ä»¶è¯»å–
- è°ƒè¯•æ¨¡å¼æ§åˆ¶
- å¤šè¯­è¨€è¾“å‡º

### Lang
å›½é™…åŒ–æ”¯æŒï¼Œå¯è½»æ¾æ·»åŠ æ–°è¯­è¨€ã€‚

## å¼€å‘å·¥å…·

### åœ°å€è§£ç æµ‹è¯•å·¥å…·

ç”¨äºæµ‹è¯•å’Œç†è§£åœ°å€ç¼–ç æœºåˆ¶ï¼š

```bash
java -cp build\classes\java\main TestDecoding
java -cp build\classes\java\main TestDecoding --lang en
```

è¯¥å·¥å…·ä¼šæ˜¾ç¤ºå„ç§æ¯”ç‰¹æµçš„è§£ç è¿‡ç¨‹ï¼Œå¸®åŠ©ç†è§£è‡ªç»ˆæ­¢ç¼–ç ã€‚

## è°ƒè¯•æ¨¡å¼

å¯ç”¨è°ƒè¯•æ¨¡å¼åï¼Œè§£é‡Šå™¨ä¼šï¼š

1. æ˜¾ç¤ºæ¯æ¡æŒ‡ä»¤çš„è§£ç è¿‡ç¨‹
2. æ˜¾ç¤ºæ‰§è¡Œå‰åçš„å†…å­˜çŠ¶æ€
3. ç­‰å¾…ç”¨æˆ·æŒ‰ Enter ç»§ç»­ï¼ˆå•æ­¥æ‰§è¡Œï¼‰
4. æ˜¾ç¤ºç¨‹åºè®¡æ•°å™¨å˜åŒ–

**ç¤ºä¾‹è¾“å‡º:**
```
=== æŒ‡ä»¤ #1 ===
PC: 0
è¯»å–åœ°å€ a: 0
è¯»å–åœ°å€ b: 0
è¯»å–åœ°å€ c: 0
æ‰§è¡Œ: mem[0] -= mem[0]
ç»“æœ: mem[0] = 0
æ¡ä»¶: 0 <= 0 (çœŸ)
è·³è½¬åˆ°: 0
[æŒ‰ Enter ç»§ç»­...]
```

## æ€§èƒ½ä¸é™åˆ¶

### é»˜è®¤é™åˆ¶

- **æœ€å¤§æŒ‡ä»¤æ•°**: 1,000,000ï¼ˆé˜²æ­¢æ— é™å¾ªç¯æŒ‚èµ·ï¼‰
- **å†…å­˜**: ä½¿ç”¨ç¨€ç–å­˜å‚¨ï¼Œç†è®ºä¸Šæ— é™
- **åœ°å€èŒƒå›´**: Java int èŒƒå›´ï¼ˆ-2Â³Â¹ ~ 2Â³Â¹-1ï¼‰

### æ€§èƒ½è€ƒè™‘

- ç¨€ç–å†…å­˜ä½¿ç”¨ HashMapï¼ŒæŸ¥æ‰¾æ—¶é—´ O(1)
- æŒ‡ä»¤è§£ç é‡‡ç”¨æµå¼è¯»å–ï¼Œç©ºé—´æ•ˆç‡é«˜
- é€‚åˆæ•™å­¦å’Œå®éªŒï¼Œä¸é€‚åˆç”Ÿäº§ç¯å¢ƒ

## å¸¸è§é—®é¢˜

### 1. ç¨‹åºä¸åœæ­¢

**åŸå› **: å¯èƒ½é™·å…¥æ— é™å¾ªç¯æˆ–æœªè®¾ç½®åœæœºæŒ‡ä»¤ã€‚

**è§£å†³**: 
- æ£€æŸ¥æ˜¯å¦æœ‰è·³è½¬åˆ° -1 çš„æŒ‡ä»¤
- ä½¿ç”¨è°ƒè¯•æ¨¡å¼è§‚å¯Ÿæ‰§è¡Œæµç¨‹
- ç¨‹åºä¼šåœ¨ 100 ä¸‡æ¡æŒ‡ä»¤åè‡ªåŠ¨ç»ˆæ­¢

### 2. æ¯”ç‰¹æµè§£æé”™è¯¯

**é”™è¯¯ä¿¡æ¯**: "ä½æµé•¿åº¦å¿…é¡»æ˜¯5çš„å€æ•°"

**è§£å†³**:
- æ£€æŸ¥è¾“å…¥æ–‡ä»¶æ˜¯å¦å®Œæ•´ï¼ˆä»…åŒ…å« 0 å’Œ 1ï¼‰
- ç¡®ä¿æ¯”ç‰¹æµé•¿åº¦æ­£ç¡®ï¼ˆæ¯æ¡æŒ‡ä»¤è‡³å°‘ 15 ä½ï¼‰

### 3. è¾“å‡ºä¹±ç 

**åŸå› **: è¾“å‡ºçš„å­—èŠ‚å€¼ä¸åœ¨å¯æ‰“å° ASCII èŒƒå›´ã€‚

**è§£å†³**:
- æ£€æŸ¥å†…å­˜ä¸­è¦è¾“å‡ºçš„å€¼
- ä½¿ç”¨ `mem[a] & 0xFF` ç¡®ä¿åœ¨ 0-255 èŒƒå›´

### 4. æ‰¾ä¸åˆ°ä¸»ç±»

**é”™è¯¯ä¿¡æ¯**: "Could not find or load main class BSMain"

**è§£å†³**:
```bash
# é‡æ–°ç¼–è¯‘
.\gradlew.bat clean build

# ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„ classpath
java -cp build\classes\java\main BSMain
```

## æ‰©å±•å¼€å‘

### æ·»åŠ æ–°è¯­è¨€

ç¼–è¾‘ `Lang.java`ï¼Œæ·»åŠ æ–°çš„è¯­è¨€ä»£ç ï¼š

```java
private void loadMessages() {
    if ("fr".equals(lang)) {  // æ³•è¯­
        messages.put("error.bitstream", "Erreur: ...");
        // ...
    }
}
```

### è‡ªå®šä¹‰å†…å­˜å¤§å°

ä¿®æ”¹ `BSInterpreter.java` ä¸­çš„ `MAX_INSTRUCTIONS` å¸¸é‡ã€‚

### æ·»åŠ æ–°çš„ I/O æ“ä½œ

åœ¨ `BSInterpreter.java` çš„ `executeInstruction()` æ–¹æ³•ä¸­æ‰©å±•ç‰¹æ®Šåœ°å€å¤„ç†é€»è¾‘ã€‚

## æµ‹è¯•æ–‡ä»¶è¯´æ˜

### test_infinite_loop.bs
æœ€ç®€å•çš„æ— é™å¾ªç¯ï¼š`000000000000000`

### test_output_a.bs
è¾“å‡ºæµ‹è¯•ç¨‹åºï¼Œæ¼”ç¤ºåŸºæœ¬ I/O æ“ä½œã€‚

## æ„å»ºäº§ç‰©

ç¼–è¯‘åç”Ÿæˆï¼š

- `build/classes/java/main/` - ç¼–è¯‘çš„ .class æ–‡ä»¶
- `build/libs/` - JAR åŒ…
- `build/reports/` - æ„å»ºæŠ¥å‘Š

## ä¾èµ–é¡¹

æ— å¤–éƒ¨ä¾èµ–ï¼Œä»…ä½¿ç”¨ Java æ ‡å‡†åº“ã€‚

**æœ€ä½è¦æ±‚**: Java 8+

## è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼š

- ğŸ› æŠ¥å‘Š Bug
- âœ¨ æå‡ºæ–°åŠŸèƒ½
- ğŸ“ æ”¹è¿›æ–‡æ¡£
- ğŸš€ æ€§èƒ½ä¼˜åŒ–
- ğŸŒ æ·»åŠ æ–°è¯­è¨€æ”¯æŒ

## ç›¸å…³èµ„æº

- **é¡¹ç›®ä¸»é¡µ**: [BS Language](../../README.md)
- **è¯­è¨€è§„èŒƒ**: [README.md](../../README.md#è¯­è¨€è§„èŒƒ)
- **è‹±æ–‡æ–‡æ¡£**: [README_EN.md](README_EN.md)

## è®¸å¯è¯

è§é¡¹ç›®æ ¹ç›®å½• [LICENSE](../../LICENSE) æ–‡ä»¶ã€‚

---

**æç¤º**: ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Ÿè¯•è¯•è¿™ä¸ªå‘½ä»¤ï¼š
```bash
java -cp build\classes\java\main BSMain -d -e 000000000000000
```
ä½“éªŒè°ƒè¯•æ¨¡å¼ï¼Œè§‚å¯Ÿç¨‹åºå¦‚ä½•æ‰§è¡Œï¼
